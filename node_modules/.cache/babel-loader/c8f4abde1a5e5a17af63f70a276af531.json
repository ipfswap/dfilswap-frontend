{"ast":null,"code":"import _regeneratorRuntime from\"/home/defi/dfilswap-frontend/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/defi/dfilswap-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import BigNumber from'bignumber.js';import{ethers}from'ethers';BigNumber.config({EXPONENTIAL_AT:1000,DECIMAL_PLACES:80});var GAS_LIMIT={STAKING:{DEFAULT:200000,SNX:850000}};export var getMasterChefAddress=function getMasterChefAddress(sushi){return sushi&&sushi.masterChefAddress;};export var getSushiAddress=function getSushiAddress(sushi){return sushi&&sushi.sushiAddress;};export var getWethContract=function getWethContract(sushi){return sushi&&sushi.contracts&&sushi.contracts.weth;};export var getMasterChefContract=function getMasterChefContract(sushi){return sushi&&sushi.contracts&&sushi.contracts.masterChef;};export var getSushiContract=function getSushiContract(sushi){return sushi&&sushi.contracts&&sushi.contracts.sushi;};export var getFarms=function getFarms(sushi){return sushi?sushi.contracts.pools.map(function(_ref){var pid=_ref.pid,name=_ref.name,symbol=_ref.symbol,icon=_ref.icon,tokenAddress=_ref.tokenAddress,tokenSymbol=_ref.tokenSymbol,tokenContract=_ref.tokenContract,lpAddress=_ref.lpAddress,lpContract=_ref.lpContract;return{pid:pid,id:symbol,name:name,lpToken:symbol,lpTokenAddress:lpAddress,lpContract:lpContract,tokenAddress:tokenAddress,tokenSymbol:tokenSymbol,tokenContract:tokenContract,earnToken:'sushi',earnTokenAddress:sushi.contracts.sushi.options.address,icon:icon};}):[];};export var getPoolWeight=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(masterChefContract,pid){var _yield$masterChefCont,allocPoint,totalAllocPoint;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return masterChefContract.methods.poolInfo(pid).call();case 2:_yield$masterChefCont=_context.sent;allocPoint=_yield$masterChefCont.allocPoint;_context.next=6;return masterChefContract.methods.totalAllocPoint().call();case 6:totalAllocPoint=_context.sent;return _context.abrupt(\"return\",new BigNumber(allocPoint).div(new BigNumber(totalAllocPoint)));case 8:case\"end\":return _context.stop();}}},_callee);}));return function getPoolWeight(_x,_x2){return _ref2.apply(this,arguments);};}();export var getEarned=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(masterChefContract,pid,account){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",masterChefContract.methods.pendingSushi(pid,account).call());case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function getEarned(_x3,_x4,_x5){return _ref3.apply(this,arguments);};}();export var getTotalLPWethValue=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(masterChefContract,wethContract,lpContract,tokenContract,pid){var tokenAmountWholeLP,tokenDecimals,balance,totalSupply,lpContractWeth,portionLp,lpWethWorth,totalLpWethValue,tokenAmount,wethAmount;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return tokenContract.methods.balanceOf(lpContract.options.address).call();case 2:tokenAmountWholeLP=_context3.sent;_context3.next=5;return tokenContract.methods.decimals().call();case 5:tokenDecimals=_context3.sent;_context3.next=8;return lpContract.methods.balanceOf(masterChefContract.options.address).call();case 8:balance=_context3.sent;_context3.next=11;return lpContract.methods.totalSupply().call();case 11:totalSupply=_context3.sent;_context3.next=14;return wethContract.methods.balanceOf(lpContract.options.address).call();case 14:lpContractWeth=_context3.sent;// Return p1 * w1 * 2\nportionLp=new BigNumber(balance).div(new BigNumber(totalSupply));lpWethWorth=new BigNumber(lpContractWeth);totalLpWethValue=portionLp.times(lpWethWorth).times(new BigNumber(2));// Calculate\ntokenAmount=new BigNumber(tokenAmountWholeLP).times(portionLp).div(new BigNumber(10).pow(tokenDecimals));wethAmount=new BigNumber(lpContractWeth).times(portionLp).div(new BigNumber(10).pow(18));_context3.t0=tokenAmount;_context3.t1=wethAmount;_context3.t2=totalLpWethValue.div(new BigNumber(10).pow(18));_context3.t3=wethAmount.div(tokenAmount);_context3.next=26;return getPoolWeight(masterChefContract,pid);case 26:_context3.t4=_context3.sent;return _context3.abrupt(\"return\",{tokenAmount:_context3.t0,wethAmount:_context3.t1,totalWethValue:_context3.t2,tokenPriceInWeth:_context3.t3,poolWeight:_context3.t4});case 28:case\"end\":return _context3.stop();}}},_callee3);}));return function getTotalLPWethValue(_x6,_x7,_x8,_x9,_x10){return _ref4.apply(this,arguments);};}();export var approve=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(lpContract,masterChefContract,account){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",lpContract.methods.approve(masterChefContract.options.address,ethers.constants.MaxUint256).send({from:account}));case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function approve(_x11,_x12,_x13){return _ref5.apply(this,arguments);};}();export var getSushiSupply=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(sushi){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.t0=BigNumber;_context5.next=3;return sushi.contracts.sushi.methods.totalSupply().call();case 3:_context5.t1=_context5.sent;return _context5.abrupt(\"return\",new _context5.t0(_context5.t1));case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function getSushiSupply(_x14){return _ref6.apply(this,arguments);};}();export var stake=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(masterChefContract,pid,amount,account){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:return _context6.abrupt(\"return\",masterChefContract.methods.deposit(pid,new BigNumber(amount).times(new BigNumber(10).pow(18)).toString()).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;}));case 1:case\"end\":return _context6.stop();}}},_callee6);}));return function stake(_x15,_x16,_x17,_x18){return _ref7.apply(this,arguments);};}();export var unstake=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(masterChefContract,pid,amount,account){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:return _context7.abrupt(\"return\",masterChefContract.methods.withdraw(pid,new BigNumber(amount).times(new BigNumber(10).pow(18)).toString()).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;}));case 1:case\"end\":return _context7.stop();}}},_callee7);}));return function unstake(_x19,_x20,_x21,_x22){return _ref8.apply(this,arguments);};}();export var harvest=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(masterChefContract,pid,account){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:return _context8.abrupt(\"return\",masterChefContract.methods.deposit(pid,'0').send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;}));case 1:case\"end\":return _context8.stop();}}},_callee8);}));return function harvest(_x23,_x24,_x25){return _ref9.apply(this,arguments);};}();export var getStaked=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(masterChefContract,pid,account){var _yield$masterChefCont2,amount;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.prev=0;_context9.next=3;return masterChefContract.methods.userInfo(pid,account).call();case 3:_yield$masterChefCont2=_context9.sent;amount=_yield$masterChefCont2.amount;return _context9.abrupt(\"return\",new BigNumber(amount));case 8:_context9.prev=8;_context9.t0=_context9[\"catch\"](0);return _context9.abrupt(\"return\",new BigNumber(0));case 11:case\"end\":return _context9.stop();}}},_callee9,null,[[0,8]]);}));return function getStaked(_x26,_x27,_x28){return _ref10.apply(this,arguments);};}();export var redeem=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(masterChefContract,account){var now;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:now=new Date().getTime()/1000;if(!(now>=1597172400)){_context10.next=5;break;}return _context10.abrupt(\"return\",masterChefContract.methods.exit().send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;}));case 5:alert('pool not active');case 6:case\"end\":return _context10.stop();}}},_callee10);}));return function redeem(_x29,_x30){return _ref11.apply(this,arguments);};}();","map":null,"metadata":{},"sourceType":"module"}